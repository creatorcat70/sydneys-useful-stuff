<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Auraa</title>
</head>
<body>

  <input type="text" id="searchInput" placeholder="Search or enter a URL" 
    style="padding: 12px; font-size: 1rem; width: 100%; max-width: 500px; margin: 100px auto; display: block; border-radius: 8px; border: 1px solid #ccc;">

  <!-- Ultraviolet Scripts -->
  <script src="/active/uv/uv.bundle.js"></script>
  <script src="/active/uv/uv.config.js"></script>
  <script src="/assets/js/register.js"></script>

  <script>
    // Helper: returns a valid URL or search URL
    function generateSearchUrl(query) {
      // Try full URL
      try {
        const url = new URL(query);
        return url.toString();
      } catch {}

      // Try domain (without protocol)
      try {
        const url = new URL("https://" + query);
        if (url.hostname.includes('.')) return url.toString();
      } catch {}

      // Otherwise, treat as search
      return `https://www.startpage.com/do/search?query=${encodeURIComponent(query)}`;
    }

    document.addEventListener("DOMContentLoaded", async () => {
      const input = document.getElementById("searchInput");
      if (!input) return;

      // Wait for UV and config to load
      await new Promise((resolve) => {
        const check = setInterval(() => {
          if (window.__uv$config && window.Ultraviolet) {
            clearInterval(check);
            resolve();
          }
        }, 50);
      });

      const uv = new Ultraviolet(__uv$config);
      uv.init();

      input.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          const query = input.value.trim();
          if (!query) return;

          const url = generateSearchUrl(query);
          const encodedUrl = __uv$config.prefix + uv.urlCodec.encode(url);

          // Navigate through UV
          window.location.href = encodedUrl;
        }
      });
    });
  </script>

</body>
</html>
